<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Styled Google Map with Postcode Pins</title>
    <style>
      #map {
        height: 100vh;
        width: 100%;
      }
    </style>
  </head>

  <body>
    <div id="map"></div>

    <script>
      // ① カスタムマップスタイルは mapId によって適用される
      const mapOptions = {
        center: { lat: 51.509865, lng: -0.118092 },
        zoom: 11,
        mapId: "12ba70801ea07ca4acc876c1"
      };

      // ② 表示したい郵便番号一覧
      const postcodes = [
        "TW80QX", "IG118SE", "N16 5BD", "N1 0HU", "E3 4PX", "E2 9RR", "AL10 0PS", "E14 7NG",
        "NW5 1HR", "SE10 0DZ", "W11 2DF", "E9 6DJ", "HA40LR", "N5 1PB", "N15 4NE", "RM3 8SB",
        "IG8 9HR", "IG6 2XL", "N21 2PJ", "W4 3LT", "E5 8RQ", "N7 6AR", "W10 6LP", "N135HE",
        "NW11 6NJ", "W7 3ET", "N10 2EY", "UB6 7PQ", "KT8 1QS", "TW76AB", "W6 9ER", "E13 9EX",
        "RM13 9DB", "NW10", "HA0 3TQ", "ST CHARLES HOSPITAL", "NW2 1QG", "N3 1SA", "E16 2ZA",
        "N166AE", "EC3A 3BP", "N15 3JS", "W10 6NX", "W7 3BA", "HA8 8BN", "W4 3NX", "E14 0XA",
        "E5 9EN", "N7 7RB", "CR4 4JA", "N41SY", "CR0 7AL"
      ];

      // ③ ピンのカスタムアイコン
      const customIcon = {
        url: "https://niki0925.github.io/custom-map/orange_fixed-01.png",
        scaledSize: new google.maps.Size(30, 30)
      };

      function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), mapOptions);
        const geocoder = new google.maps.Geocoder();

        postcodes.forEach((postcode) => {
          if (!postcode || postcode === "NAN") return; // 無効な値はスキップ
          geocoder.geocode({ address: postcode + ", UK" }, (results, status) => {
            if (status === "OK") {
              new google.maps.Marker({
                position: results[0].geometry.location,
                map: map,
                title: postcode,
                icon: customIcon
              });
            } else {
              console.warn("Geocode failed for " + postcode + ": " + status);
            }
          });
        });
      }
    </script>

    <script async
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAZXv9GozgY4-cJuEg-rFJZX1fUJY-EEno&callback=initMap">
    </script>
  </body>
</html>